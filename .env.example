# ====================================
# Go WhatsApp Service Configuration
# ====================================

# Application Environment
# Options: production, staging, development
APP_ENV=production

# Server Port
PORT=4001

# ====================================
# Database Configuration
# ====================================
# PostgreSQL connection string
# Format: postgres://username:password@host:port/database?sslmode=require
DATABASE_URL=postgres://whatsapp_user:your_secure_password@localhost:5432/whatsapp_db?sslmode=require

# ====================================
# Laravel Integration
# ====================================
# Base URL for Laravel webhook endpoints (without trailing slash)
LARAVEL_WEBHOOK_BASE=https://your-laravel-app.com/api/webhooks/whatsapp

# Signing secret for webhook HMAC signatures (generate a strong random string)
# Generate with: openssl rand -hex 32
GO_WA_SIGNING_SECRET=your_64_character_hex_string_here_generate_with_openssl_rand

# ====================================
# Session Management
# ====================================
# How long to keep idle sessions connected before disconnecting
# Format: Duration string (e.g., 6h, 30m, 1h30m)
SESSION_IDLE_TTL=6h

# Maximum number of concurrent WhatsApp sessions
MAX_CONCURRENT_SESSIONS=10000

# ====================================
# Rate Limiting Configuration
# ====================================
# Default messages per minute rate limit per account
SEND_RATE_PER_MINUTE_DEFAULT=15

# Jitter range in milliseconds to prevent thundering herd
# Random delay between min and max will be added before each message
SEND_JITTER_MIN_MS=200
SEND_JITTER_MAX_MS=600

# ====================================
# Webhook Configuration
# ====================================
# Timeout for webhook HTTP requests
WEBHOOK_TIMEOUT=10s

# Maximum number of retry attempts for failed webhooks
WEBHOOK_RETRY_MAX=3

# Base backoff duration for webhook retries (exponential backoff)
WEBHOOK_RETRY_BACKOFF_BASE=2s

# ====================================
# Logging Configuration
# ====================================
# Log level: debug, info, warn, error
LOG_LEVEL=info

# Enable JSON logging (recommended for production)
LOG_JSON=true

# ====================================
# Monitoring & Observability
# ====================================
# Enable Prometheus metrics endpoint (/metrics)
METRICS_ENABLED=true

# Enable health check endpoints (/healthz, /readyz)
HEALTH_CHECK_ENABLED=true

# ====================================
# Security
# ====================================
# Allowed CORS origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://your-laravel-app.com,https://admin.your-laravel-app.com

# Enable CORS credentials
CORS_ALLOW_CREDENTIALS=true

# ====================================
# Performance Tuning
# ====================================
# Database connection pool settings
DB_MAX_OPEN_CONNS=50
DB_MAX_IDLE_CONNS=10
DB_CONN_MAX_LIFETIME=1h

# HTTP server timeouts
HTTP_READ_TIMEOUT=30s
HTTP_WRITE_TIMEOUT=30s
HTTP_IDLE_TIMEOUT=120s

# Context timeouts for various operations
CONTEXT_TIMEOUT_SHORT=5s
CONTEXT_TIMEOUT_MEDIUM=30s
CONTEXT_TIMEOUT_LONG=60s

# ====================================
# WhatsApp Specific Settings
# ====================================
# QR code image size in pixels
QR_CODE_SIZE=256

# QR code timeout duration
QR_CODE_TIMEOUT=60s

# Media upload/download timeout
MEDIA_TIMEOUT=120s

# Maximum file size for media uploads (in bytes)
# 16MB default (WhatsApp limit is 16MB for most media)
MAX_MEDIA_SIZE=16777216

# ====================================
# Development/Debug Settings
# ====================================
# Enable debug mode (do not use in production)
DEBUG_MODE=false

# Enable request/response logging
REQUEST_LOGGING=true

# Log SQL queries (only for debugging)
LOG_SQL_QUERIES=false

# ====================================
# Backup & Recovery
# ====================================
# Enable automatic device store backups
AUTO_BACKUP_ENABLED=true

# Backup interval
AUTO_BACKUP_INTERVAL=24h

# Backup retention period
BACKUP_RETENTION=30d

# ====================================
# Feature Flags
# ====================================
# Enable message encryption
MESSAGE_ENCRYPTION=true

# Enable media compression
MEDIA_COMPRESSION=true

# Enable webhook retry mechanism
WEBHOOK_RETRY_ENABLED=true

# Enable rate limiting
RATE_LIMITING_ENABLED=true

# Enable idempotency checks (prevent duplicate message sends)
IDEMPOTENCY_ENABLED=true
IDEMPOTENCY_TTL=24h

# ====================================
# External Services
# ====================================
# Redis URL for caching and rate limiting (optional but recommended for production)
# REDIS_URL=redis://localhost:6379/0

# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ====================================
# Deployment Information
# ====================================
# Application version (set by CI/CD)
# APP_VERSION=1.0.0

# Git commit hash (set by CI/CD)
# GIT_COMMIT=abc123

# Build timestamp (set by CI/CD)
# BUILD_TIME=2025-01-01T00:00:00Z